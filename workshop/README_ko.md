## GitHub Copilot로 레거시 프로젝트 업그레이드하기

이 워크숍에서는 레거시(구버전) Python 애플리케이션을 최신 Python 버전으로 업그레이드하는 과정을 GitHub Copilot의 도움을 받아 단계별로 진행합니다.

> [!NOTE]
> 이 저장소는 **GitHub Copilot**의 다양한 기능(예: **Copilot Chat**, **인라인 채팅**)을 소개하기 위한 것입니다. 아래 단계별 가이드에는 해야 할 일의 일반적인 설명이 포함되어 있으며, Copilot Chat 또는 인라인 채팅이 필요한 명령어 생성을 지원할 수 있습니다.
>
> 각 단계(해당되는 경우)에는 Copilot의 제안이 올바른 명령인지 검증할 수 있는 `Cheatsheet`도 포함되어 있습니다.
>
> 💡 다양한 프롬프트로 실험해 보세요. 인라인 채팅에서는 추가 프롬프트로 응답을 더 세밀하게 다듬을 수 있습니다.

## 워크숍 특징

이 워크숍에서는 Python 2.5 버전을 사용하던 레거시 Python 애플리케이션을 다루게 됩니다. 주요 특징은 다음과 같습니다:

1. 모든 의존성은 미리 설치되어 있지만, 레거시 애플리케이션은 구버전 Python을 사용합니다.
1. 애플리케이션은 Sqlite3과 구식 Python 문법을 사용하고 있습니다. 이를 최신 문법으로 업데이트할 수 있습니다.
1. 레거시 애플리케이션에는 기능 테스트에 활용할 수 있는 문서가 포함되어 있습니다.
1. 단위 테스트와 기능 테스트가 레거시 코드에 포함되어 있습니다.


### 1. 에이전트로 프로젝트 탐색하기

`@workspace` 에이전트를 사용해 프로젝트의 구조와 동작을 설명해 보세요.

- GitHub Copilot Chat을 열고 프롬프트 앞에 `@workspace`를 붙여 질문하세요.
- 예시: 이 프로젝트가 의존성을 어떻게 설치하는지 물어보세요.

### 2. 레거시 문제와 포팅 이슈 파악

Python 애플리케이션의 테스트를 실행해 보세요. `pytest`가 미리 설치되어 있으니 결과를 확인해 보세요. 어떤 일이 발생하나요?

- `@workspace 이 코드를 최신 Python으로 포팅할 때 발생할 수 있는 문제는?` 등 질문해 보세요.
- 가상환경을 만들어 의존성 설치도 시도해 보세요.

> [!NOTE]
> 왜 안 될 수 있을까요? 레거시 Python은 더 이상 지원되지 않는 `distribute`를 사용하므로 의존성 설치가 실패할 수 있습니다.
> Copilot에게 다른 설치 방법을 제안해 달라고 요청해 보세요.


### 3. 모든 코드를 업그레이드 디렉터리로 복사

코드를 포팅하려면 모든 코드를 `upgraded` 디렉터리로 복사해야 합니다. 이곳에서 코드를 작업하게 됩니다.

- 기능 테스트를 활용해 집중할 _slice_를 정하세요.
- 
> [!NOTE]
> 비즈니스 로직상 일부 구성요소가 LLM에 명확히 드러나지 않을 수 있으니, 설명이 완벽하지 않을 수 있습니다.


### 4. 프로젝트 설치

가상환경을 만들고 프로젝트를 설치하세요. `python setup.py develop`을 실행해 오류가 무엇인지 파악하세요.

- 오류 메시지를 Copilot Chat에 붙여넣고 원인을 물어보세요.
- `#file:setup.py`로 파일을 맥락에 추가하세요.
- Copilot의 제안대로 오류를 수정하고 설치를 완료하세요.


### 5. 테스트 실행

이 프로젝트는 `pytest` 프레임워크와 CLI 도구가 설치되어 있습니다. 단위 테스트를 실행해 오류를 확인하세요.

- 오류 출력을 Copilot에 붙여넣고(` #terminalSelection`), 추가 설명을 요청하세요.
- Copilot의 답변을 검토하고 필요하면 추가 질문을 하세요.
- 아직 코드를 수정하지 마세요.

> [!NOTE]
> 오류가 바로 이해되지 않거나 Python 버전이 구식임을 나타낼 수 있습니다. 추가 질문을 통해 오류의 원인을 파악하고 전략을 세우세요. 프로젝트가 오래된 Python 버전임을 Copilot에 힌트로 제공해도 좋습니다.

### 6. try/except 오류 수정

기능 테스트를 활용해 집중할 _slice_를 정하세요. 이번에는 try/except 오류를 고칩니다.

- Copilot에게 Python 버전이 옛날임을 언급하며 실제 문제 해결을 요청하세요.
- 모든 try/except 오류를 고치고, 테스트를 반복 실행해 오류가 해결됐는지 확인하세요.

> [!NOTE]
> 예외 처리 외에도 다른 오류가 있을 수 있습니다. try/except 오류가 모두 해결된 후 다음 단계로 넘어가세요.


### 7. ConfigParser 문제 해결

다음 _slice_는 `ConfigParser`가 사용 불가한 문제입니다. Copilot에게 해결 전략을 요청하세요.

- 예시: _"이 프로젝트는 Python 2.5로 작성됐고, Python 3.9에서 다음과 같은 오류가 납니다:"_ 와 함께 테스트 출력을 붙여넣으세요.
- 간단한 해결책이 있을 수 있습니다. 하나를 선택해 바로 적용하세요.
- 테스트를 실행해 변경 사항이 올바른지 확인하세요.

[!NOTE]
> 모든 테스트가 통과해야 합니다. 통과하지 않으면 Copilot에 테스트 출력을 붙여넣고 이전 단계를 반복하세요.


### 8. 테스트를 Pytest로 포팅

Pytest는 Python에서 가장 널리 쓰이고 강력한 테스트 프레임워크입니다. 레거시 코드는 `unittest`를 사용하고 있는데, 이는 `pytest`만큼 유연하지 않습니다. 모든 테스트를 `pytest`로 포팅하고 실행하세요.

- 테스트 파일에서 `@workspace` 에이전트로 pytest로 포팅하는 방법을 물어보세요.
- 테스트 함수로 작성할 수 있다면 클래스 대신 함수로 작성해 보세요.
- 하나의 테스트를 작성한 후 Copilot에게 다음 테스트 생성을 제안해 달라고 하세요.

> [!NOTE]
> `pytest`는 `unittest` 테스트도 실행할 수 있지만, 더 강력하고 유연한 pytest로 포팅하는 것이 좋습니다. 앞으로 테스트를 추가하거나 수정할 때도 도움이 됩니다.

### 9. 최신 패키징 적용

레거시 코드는 `distribute`를 사용하고, 여전히 `setup.py` 기반의 `setuptools`를 사용합니다. 이제는 `pyproject.toml`로 패키징하는 것이 표준입니다.

- Copilot에게 `pyproject.toml` 파일 작성법을 물어보세요. `@workspace` 에이전트로 질문하고, `setup.py` 파일을 열어 맥락으로 제공하세요.
- 새 `pyproject.toml` 파일을 만들고 Copilot의 제안으로 내용을 채우세요.
- `pyproject.toml` 파일로 프로젝트를 설치하세요. `pip install .`로 편집 모드 설치가 가능합니다.

> [!NOTE]
> Python 패키징은 여전히 어려운 주제입니다. `pyproject.toml`이 표준이지만, 아직 널리 쓰이지는 않습니다. Copilot의 제안을 참고하되, 반드시 내용을 검증하고 설치를 테스트하세요.

### 10. GitHub Actions로 자동화

레거시 프로젝트에는 자동화가 없습니다. GitHub Actions를 사용해 테스트와 프로젝트 설치를 자동화하세요. 목표는 모든 pull request마다 워크플로우가 실행되어 테스트와 설치를 검증하는 것입니다.

- `@workspace` 에이전트로 GitHub Actions 워크플로우 작성법을 물어보세요.
- 워크플로우 파일과 디렉터리를 만들어 자동화하세요.
- 변경 사항을 푸쉬해 GitHub Actions가 동작하는지 확인하세요.

> [!NOTE]
> 자동화 구축은 현대 소프트웨어 개발의 핵심이지만, 완벽하게 만들기까지 시간이 걸릴 수 있습니다. 인내심을 갖고 Copilot의 도움을 받아 오류를 해결해 나가세요.
